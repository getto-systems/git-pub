#!/bin/bash

git_parent_main(){
  local current
  local parent

  current=$(git rev-parse --abbrev-ref HEAD)

  if [ -n "$(git branch -a | grep "remotes/origin/$current"'$')" ]; then
    echo $current
  else
    parent=$(git show-branch | grep '*' | grep -v "\[$current\(\^[0-9]*\)\?\]" | head -1 | sed 's/.*\[\([^]^~]*\).*/\1/')
    echo "${parent:-master}"
  fi
}

git_parent_main
